$(document).ready(function(){libCommon.init.setupJQuery();const $transportTotalStorage=$("#calcStorage"),$unionInvitedUsersList=$("#ACSUser_Invited"),$unionInvitableUsersList=$("#ACSUser_2Invite"),$unionUsersChangedInput=$('[name="acsuserschanged"]'),getCurrentTransportTotalStorage=()=>{const formattedValue=$transportTotalStorage.html();return parseInt(libCommon.normalize.removeNonDigit(formattedValue),10)},updateTransportTotalStorage=newValue=>{const isEnoughStorageForPlanetResources=newValue>=TotalPlanetResources,formattedNewValue=libCommon.format.addDots(newValue);$transportTotalStorage.toggleClass("orange",!isEnoughStorageForPlanetResources).toggleClass("lime",isEnoughStorageForPlanetResources),$transportTotalStorage.html(formattedNewValue)},handleShipInputUpdate=$input=>{const newValueRaw=parseInt(libCommon.normalize.removeNonDigit($input.val()),10),oldValueRaw=$input.data("oldCount"),newValue=Number.isNaN(newValueRaw)?0:newValueRaw,oldValue=void 0===oldValueRaw||isNaN(oldValueRaw)?0:oldValueRaw,valueDiff=newValue-oldValue;if(0!=valueDiff){const thisShipId=libCommon.normalize.removeNonDigit($input.attr("name")),transportTotalStorage=getCurrentTransportTotalStorage(),storageChange=valueDiff*ShipsData[thisShipId].storage;updateTransportTotalStorage(transportTotalStorage+storageChange);const isUsingMoreThanAvailableShips=newValue>ShipsData[thisShipId].count;$input.data("oldCount",newValue),$input.toggleClass("red",isUsingMoreThanAvailableShips)}$input.prettyInputBox()};$('[name^="ship"]').on("keydown",function(event){if(38!=event.which&&40!=event.which)return;const currentCountRaw=parseFloat(libCommon.normalize.removeNonDigit($(this).val())),currentCount=Number.isNaN(currentCountRaw)?0:currentCountRaw,incrementBy=38==event.which?1:-1,nextCount=currentCount+incrementBy,nextCountNormalized=nextCount>=0?nextCount:0;$(this).val(nextCountNormalized),handleShipInputUpdate($(this))}).on("keyup",function(){handleShipInputUpdate($(this))}).on("change",function(){handleShipInputUpdate($(this))}).on("focus",function(){"0"==$(this).val()&&$(this).val("")}).on("blur",function(){""==$(this).val()&&$(this).val("0")}),$(".maxShip").on("click",function(){const $shipRow=$(this).closest("[data-shipid]"),shipId=$shipRow.data("shipid"),$inputElement=$shipRow.find("#ship"+shipId);$inputElement.val(ShipsData[shipId].count),handleShipInputUpdate($inputElement)}),$(".noShip").on("click",function(){const $shipRow=$(this).closest("[data-shipid]"),shipId=$shipRow.data("shipid"),$inputElement=$shipRow.find("#ship"+shipId);$inputElement.val(0),handleShipInputUpdate($inputElement)}),$(".maxShipAll").on("click",function(){$(".maxShip").click()}),$(".noShipAll").on("click",function(){$(".noShip").click()}),$("#ACSUserAdd").on("click",function(){const $invitedUsersListElements=$unionInvitedUsersList.find("option"),$selectedListOption=$unionInvitableUsersList.children("option:selected");$invitedUsersListElements.length>=ACSUsersMax+1||!$selectedListOption.length||($selectedListOption.appendTo($unionInvitedUsersList),$selectedListOption.prop("selected",!1),$unionUsersChangedInput.val("1"))}),$("#ACSUserRmv").on("click",function(){const $selectedListOption=$unionInvitedUsersList.children("option:selected");$selectedListOption.length&&!$selectedListOption.is(":disabled")&&($selectedListOption.appendTo($unionInvitableUsersList),$selectedListOption.prop("selected",!1),$unionUsersChangedInput.val("1"))}),$("#ACSForm").on("submit",function(){const userIds=$unionInvitedUsersList.children("option").map(function(){return $(this).val()}).toArray(),userIdsString=userIds.join(",");$('[name="acs_users"]').val(userIdsString)}),$(".setACS_ID").on("click",function(){$("[name=getacsdata]").val($(this).val())}),$('[name^="ship"]').each(function(){handleShipInputUpdate($(this))}),$(".addPad2").children(":not(.pad5)").addClass("pad2"),$(".FBeh").tipTip({maxWidth:"250px",attribute:"title",delay:0,edgeOffset:8}),$(".Speed").tipTip({maxWidth:"250px",attribute:"title",delay:0,edgeOffset:8}),$(".fInfo").tipTip({maxWidth:"300px",minWidth:"200px",attribute:"title",delay:0,edgeOffset:8}),$(".planet").tipTip({content:JSLang.fl_coordplanet,delay:0,edgeOffset:8}),$(".moon").tipTip({content:JSLang.fl_coordmoon,delay:0,edgeOffset:8}),$(".debris").tipTip({content:JSLang.fl_coorddebris,delay:0,edgeOffset:8})});