$(document).ready(function(){var FlightDuration;function setTarget(galaxy,system,planet,type){$("#galaxy_selector").val(galaxy),$("#system_selector").val(system),$("#select_planet").val(planet),$("#type_selector").val(type)}function distance(){var thisGalaxy=parseInt($("#ThisGalaxy").val(),10),thisSystem=parseInt($("#ThisSystem").val(),10),thisPlanet=parseInt($("#ThisPlanet").val(),10),targetGalaxy=parseInt($("#galaxy_selector").val(),10),targetSystem=parseInt($("#system_selector").val(),10),targetPlanet=parseInt($("#select_planet").val(),10),dist=0;return dist=targetGalaxy-thisGalaxy!=0?2e4*Math.abs(targetGalaxy-thisGalaxy):targetSystem-thisSystem!=0?95*Math.abs(targetSystem-thisSystem)+2700:targetPlanet-thisPlanet!=0?5*Math.abs(targetPlanet-thisPlanet)+1e3:5}function duration(){var ret=Math.round((35e3/speed()*Math.sqrt(10*distance()/maxspeed())+10)/speedFactor());return FlightDuration=ret,!0===AllowCreateTimeCounters&&createTimeCounters(),ret}function maxspeed(){return parseInt($("#MaxSpeed").val(),10)}function speed(){return parseFloat($(".setSpeed_Current").attr("data-speed"))}function speedFactor(){return parseInt($("#SpeedFactor").val(),10)}function consumption(){var calc_consumption=0,i,dist=distance(),dur=duration(),speedfactor=speedFactor();for(i=200;i<300;i+=1){const thisShipDetails=shipsDetails[i];if(!thisShipDetails)continue;const allShipsBaseConsumption=parseInt(thisShipDetails.totalConsumptionOfShipType,10),shipSpeed=parseInt(thisShipDetails.speed,10),finalSpeed=35e3/(dur*speedfactor-10)*Math.sqrt(10*dist/shipSpeed),allShipsConsumption=allShipsBaseConsumption*dist/35e3*(finalSpeed/10+1)*(finalSpeed/10+1);calc_consumption+=allShipsConsumption}return Math.round(calc_consumption)+1}function storage(){return parseInt($("#Storage").val(),10)-consumption()}function GetFuelStorage(){return parseInt($("#FuelStorage").val(),10)}function planetDeuterium(){return parseInt($("#PlanetDeuterium").val(),10)}function shortInfo(){$("#distance").html(libCommon.format.addDots(distance()));var seconds=duration(),hours=Math.floor(seconds/3600);seconds-=3600*hours;var minutes=Math.floor(seconds/60);seconds-=60*minutes,minutes<10&&(minutes="0"+minutes),seconds<10&&(seconds="0"+seconds),hours<10&&(hours="0"+hours),$("#duration").html(hours+":"+minutes+":"+seconds+" h");var stor=storage(),cons=consumption(),FuelStorage=GetFuelStorage();stor+=FuelStorage>=cons?cons:FuelStorage;var deuterium=planetDeuterium(),setHTMLCons="",setHTMLStor="";stor>=0?(setHTMLCons=deuterium>=cons?'<b class="lime">'+libCommon.format.addDots(cons)+"</b>":'<b class="red">'+libCommon.format.addDots(cons)+"</b>",setHTMLStor='<b class="lime">'+libCommon.format.addDots(stor)+"</b>"):(setHTMLCons=deuterium>=cons?'<b class="orange">'+libCommon.format.addDots(cons)+"</b>":'<b class="red">'+libCommon.format.addDots(cons)+"</b>",setHTMLStor='<b class="red">'+libCommon.format.addDots(stor)+"</b>"),$("#consumption").html(setHTMLCons),$("#storageShow").html(setHTMLStor)}function createTimeCounters(){const currentTimeFormatted=libCommon.format.formatDateToFlightEvent(0),reachTimeFormatted=libCommon.format.formatDateToFlightEvent(1e3*FlightDuration),backTimeFormatted=libCommon.format.formatDateToFlightEvent(2*FlightDuration*1e3);$("#curr_time").html(currentTimeFormatted),$("#reach_time").html(reachTimeFormatted),$("#comeback_time").html(backTimeFormatted)}libCommon.init.setupJQuery(),setInterval(createTimeCounters,250),$("th:not(.FBlock, .inv), .updateInfo").addClass("pad2"),$(".updateInfo:not(.fastLink, select, .setSpeed)").keyup(function(){if($(this).isNonEmptyValue({isZeroAllowed:!0})){var TName=$(this).attr("name");"galaxy"!=TName&&"system"!=TName&&"planet"!=TName||($(this).val()<1?$(this).val(1):$(this).val()>maxIs[TName]&&$(this).val(maxIs[TName])),shortInfo()}}).change(function(){$(this).keyup()}).focus(function(){$(this).isNonEmptyValue()&&($(this).data("last_val",$(this).val()),$(this).val(""))}).blur(function(){$(this).isNonEmptyValue()||$(this).isNonEmptyDataSlot("last_val")&&($(this).val($(this).data("last_val")),$(this).data("last_val",""))}),$("select.updateInfo:not(.fastLink)").keyup(function(){shortInfo()}).change(function(){$(this).keyup()}),$(".setSpeed").click(function(){return $('input[name="speed"]').val($(this).attr("data-speed")),$(".setSpeed_Selected").removeClass("setSpeed_Selected"),$(this).addClass("setSpeed_Selected"),shortInfo(),!1}).hover(function(){""!=$('input[name="galaxy"]').val()&&""!=$('input[name="system"]').val()&&""!=$('input[name="planet"]').val()&&($(".setSpeed_Current").removeClass("setSpeed_Current"),$(this).addClass("setSpeed_Current"),shortInfo())},function(){""!=$('input[name="galaxy"]').val()&&""!=$('input[name="system"]').val()&&""!=$('input[name="planet"]').val()&&($(this).removeClass("setSpeed_Current"),$(".setSpeed_Selected").addClass("setSpeed_Current"),shortInfo())}),$(".fastLink").keyup(function(){if("-"!==$(this).val()){var coordinates=$(this).val().split(",");setTarget(coordinates[0],coordinates[1],coordinates[2],coordinates[3]),shortInfo()}var GetIDNum=$(this).attr("id").substr(6);GetIDNum="1"==GetIDNum?2:1,$("#fl_sel"+GetIDNum).val("-").attr("selected",!0)}).change(function(){$(this).keyup()}),$("[name=galaxy]").tipTip({delay:0,edgeOffset:8,content:JSLang.fl1_targetGalaxy}),$("[name=system]").tipTip({delay:0,edgeOffset:8,content:JSLang.fl1_targetSystem}),$("[name=planet]").tipTip({delay:0,edgeOffset:8,content:JSLang.fl1_targetPlanet}),$("#goBack").click(function(){$("#thisForm").attr("action","fleet.php").prepend('<input type="hidden" name="gobackUsed" value="1"/>').submit()}),$("#thisForm").submit(function(){$("#galaxy_selector").isNonEmptyValue()||$("#galaxy_selector").isNonEmptyDataSlot("last_val")&&($("#galaxy_selector").val($("#galaxy_selector").data("last_val")),$("#galaxy_selector").data("last_val","")),$("#system_selector").isNonEmptyValue()||$("#system_selector").isNonEmptyDataSlot("last_val")&&($("#system_selector").val($("#system_selector").data("last_val")),$("#system_selector").data("last_val","")),$("#select_planet").isNonEmptyValue()||$("#select_planet").isNonEmptyDataSlot("last_val")&&($("#select_planet").val($("#select_planet").data("last_val")),$("#select_planet").data("last_val",""))}),shortInfo()});